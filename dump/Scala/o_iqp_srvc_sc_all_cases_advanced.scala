import org.apache.spark.sql.SparkSession
import org.apache.spark.sql.Dataset
import org.apache.spark.sql.DataFrame
import org.apache.spark.SparkContext
import org.apache.spark.SparkContext._
import java.io.File
import org.apache.spark.storage.StorageLevel
import java.text.SimpleDateFormat
object o_iqp_srvc_sc_all_cases
{
  val tableName = "g00103.iqp_srvc_sc_all_cases"
  val sConnect = new Utils.sparkConnection
  //val spark = sConnect.connect(tableName)
  val spark = SparkSession.builder
      .appName(tableName)
      .config("spark.some.config.option", "config-value")
//    .config("spark.sql.warehouse.dir", warehouseLocation)
//    .config("orc.compress","ZLIB")
      .enableHiveSupport()
      .getOrCreate()
      spark.conf.set("spark.serializer", "org.apache.spark.serializer.KryoSerializer")
      spark.conf.set("spark.kryo.registrationRequired", "true")
      spark.conf.set("spark.scheduler.mode", "FAIR")
      spark.conf.set("spark.sql.orc.filterPushdown", "true")
      spark.conf.set("spark.storage.StorageLevel","MEMORY_ONLY_SER")
      spark.conf.set("spark.kryo.classesToRegister", "AuditTableSchema")
  spark.conf.set("spark.sql.autoBroadcastJoinThreshold",52428800)
def main(args: Array[String])={
val deBug = args.exists{ x => x.toLowerCase.contains("debug=true") }
      var isSuccess: Boolean = true
      var errorMessage: String = ""
      val batchNumber = spark.sparkContext.applicationId
      val beforeTimestamp: Long = System.currentTimeMillis()
      val formatter = java.text.NumberFormat.getIntegerInstance
      if (deBug) Utils.printLog(deBug,tableName + ": Debug is Enabled for batchNumber: " + batchNumber)
try {
def parsedate(value : String,dformat: String) = {
try {
val dkl = new java.text.SimpleDateFormat(dformat)
dkl.parse("\""+value+"\"")
}
catch {
case e: Exception => null
}
}
def formatdate(value : java.util.Date) = {
try {
val f1 = new java.text.SimpleDateFormat("yyyy-MM-dd")
f1.format(value)
}
catch {
case e: Exception => null
}
}
spark.udf.register("date_game", (v_date:String)=> {
val d1 = "\"MMMMM dd,yyyy\""
val d2 = "\"dd-MMM-yy\""
val d3 = "\"MM/dd/yyyy H:m:S\""
val d4 = "\"MM/dd/yyyy\""
val d5 = "\"EEEEEE    MMM dd H:m:s  yyyy\""
val x =if (parsedate(v_date,d1) != null){
val q1= parsedate(v_date,d1)
formatdate(q1)
} else if (parsedate(v_date,d2) != null){
formatdate(parsedate(v_date,d2))
} else if (parsedate(v_date,d3) != null){
formatdate(parsedate(v_date,d3))
} else if (parsedate(v_date,d4) != null){
formatdate(parsedate(v_date,d4))
} else if (parsedate(v_date,d5) != null){
formatdate(parsedate(v_date,d5))
}else {
"False"
}
x.toString
})
//Create DF for srvc_all_cases_open
val df_srvc_all_cases_open = spark.sql(""" SELECT 'OPEN_CASES' AS CASE_SOURCE, product
, version , customer_business_name
, case_id , want_date
, status , country
, state , subject
, case_owner , ge_site
, reason , open_date
, last_modified_dt , prod_serv_id
, customer_priority , severity
, bug_report , resolution_responsibility
, case_type , type
, case_status , responsibility
, customer_id , planned_date
, workaround , restoration_date
, topic , produkt
, produktversion , date_dofficialisation
, created_date,NULL as actual_completion_date from g00103.IQP_SRVC_OPEN_CASES_VW """)
//Create DF for srvc_all_cases_close
val df_srvc_all_cases_close = spark.sql(""" SELECT 'CLOSED_CASES' AS CASE_SOURCE, product
, version , customer_name
, case_id , want_date
, status , country
, state , subject
, case_owner , ge_site
, reason , open_date
, last_modified_dt , prod_serv_id
, customer_priority , severity
, bug_report , resolution_responsibility
, case_type , type
, case_status , responsibility
, customer_id , planned_date
, workaround , restoration_date
, topic , produkt
, produktversion , date_dofficialisation
, created_date,actual_completion_date  from g00103.IQP_SRVC_CLOSED_CASES_VW """)
//Union DF for srvc_all_cases_open_close and create temp view
val df_srvc_all_cases_open_close = df_srvc_all_cases_open.union(df_srvc_all_cases_close)
df_srvc_all_cases_open_close.createOrReplaceTempView("intl_tbl_all_cases")
//if (deBug) Utils.printLog(deBug,tableName + ": DF df_lkp_slamaster_ff:" + formatter.format(spark.sql("select 1 from intl_tbl_all_cases").count))
spark.sql("CACHE TABLE intl_tbl_all_cases")
//Create Temporary view for IQP_SRVC_COMMUNITY_PNL_SITE_FF 
val df_lkp_pnl_site_ff = spark.sql("select pnl,community_id,product,contract_type,site,region from g00103.IQP_SRVC_COMMUNITY_PNL_SITE_FF")
df_lkp_pnl_site_ff.createOrReplaceTempView("intl_tbl_pnl_site_ff")
//if (deBug) Utils.printLog(deBug,tableName + ": DF df_lkp_pnl_site_ff:" + formatter.format(spark.sql("select 1 from intl_tbl_pnl_site_ff").count))
spark.sql("CACHE TABLE intl_tbl_pnl_site_ff")
//Create Temporary view for IQP_SRVC_SC_CUSTOMER_REGION_FF 
val df_lkp_cust_region_ff = spark.sql("select customer,Region from g00103.IQP_SRVC_SC_CUSTOMER_REGION_FF")
df_lkp_cust_region_ff.createOrReplaceTempView("intl_tbl_cust_region_ff")
//if (deBug) Utils.printLog(deBug,tableName + ": DF df_lkp_cust_region_ff:" + formatter.format(spark.sql("select 1 from intl_tbl_cust_region_ff").count))
spark.sql("CACHE TABLE intl_tbl_cust_region_ff")
//Create Temporary view for IQP_SRVC_SC_RESPONSIBILITY_LKUP_FF 
val df_lkp_resp_ff = spark.sql("select Reason_Code,Owner from g00103.IQP_SRVC_SC_RESPONSIBILITY_LKUP_FF")
df_lkp_resp_ff.createOrReplaceTempView("intl_tbl_resp_ff")
//if (deBug) Utils.printLog(deBug,tableName + ": DF df_lkp_resp_ff:" + formatter.format(spark.sql("select 1 from intl_tbl_resp_ff").count))
spark.sql("CACHE TABLE intl_tbl_resp_ff")
//Create Temporary view for SRVC_SLA_MASTER FF 
val df_lkp_slamaster_ff = spark.sql("SELECT SEVERITY,SLA FROM g00103.IQP_SRVC_SC_SLA_MASTER_FF")
df_lkp_slamaster_ff.createOrReplaceTempView("intl_tbl_slamaster_ff")
//if (deBug) Utils.printLog(deBug,tableName + ": DF df_lkp_slamaster_ff:" + formatter.format(spark.sql("select 1 from intl_tbl_slamaster_ff").count))
spark.sql("CACHE TABLE intl_tbl_slamaster_ff")
//Final DF for df_srvc_stg_ir_open_close
val finalResultToWrite = spark.sql("""SELECT
CASE_SOURCE AS CASE_SOURCE,
CASE_ID,
case when regexp_extract(OPEN_DATE,'(19|20)[0-9]{2}(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])',0) = '' 
     then NULL 
     else TO_DATE(OPEN_DATE)
end AS OPEN_DATE, 
case when regexp_extract(ACTUAL_COMPLETION_DATE,'(19|20)[0-9]{2}(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])',0) = '' 
     then NULL 
     else TO_DATE( ACTUAL_COMPLETION_DATE)
end AS CLOSED_DATE,
REASON AS REASON_CODE,
IF(ISNULL(IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)) AND (PROD_SERV_ID='97789' OR PROD_SERV_ID='119827'),'Florida',IF(PROD_SERV_ID='100588','Dallas',IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE))) AS GE_SITE,
PROD_SERV_ID AS COMMUNITY_ID,
IF((IF(IF(ISNULL(IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE))) AND (PROD_SERV_ID='97789' OR PROD_SERV_ID='119827'),'Florida',IF(PROD_SERV_ID='100588','Dallas',IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)))='Florida' and isnull(if(substr(IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))) in ('Core GIS','GIS Core','Smallworld View','Smallworld') OR
substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,23)='Core Spatial Technology' OR 
(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='PNI' OR substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,26)='Physical Network Inventory','PNI',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,11)='Cornerstone','Cornerstone',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld Translator Suite (SOMs)' OR IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Translators (SOMs)','SOMs',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Electric Office'))='Electric Office'
 ,'EO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Global Transmission Office'))='Global Transmission Office'
,'GTO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Water Office'))='Water Office'
,'WO',
IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))))))))))))))))))))),0,7)='PowerOn' or PROD_SERV_ID='47866','Automation',if(PROD_SERV_ID='99159'
OR PROD_SERV_ID='99423'
OR PROD_SERV_ID='35028'
OR PROD_SERV_ID='33643'
OR PROD_SERV_ID='27969'
OR PROD_SERV_ID='100588','Smallworld',intl_tbl_pnl_site_ff.pnl))),'Automation',if(substr(IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))) in ('Core GIS','GIS Core','Smallworld View','Smallworld') OR
substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,23)='Core Spatial Technology' OR 
(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='PNI' OR substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,26)='Physical Network Inventory','PNI',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,11)='Cornerstone','Cornerstone',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld Translator Suite (SOMs)' OR IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Translators (SOMs)','SOMs',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Electric Office'))='Electric Office'
 ,'EO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Global Transmission Office'))='Global Transmission Office'
,'GTO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Water Office'))='Water Office'
,'WO',
IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))))))))))))))))))))),0,7)='PowerOn' or PROD_SERV_ID='47866','Automation',if(PROD_SERV_ID='99159'
OR PROD_SERV_ID='99423' OR PROD_SERV_ID='35028' OR PROD_SERV_ID='33643' OR PROD_SERV_ID='27969' OR PROD_SERV_ID='100588','Smallworld',intl_tbl_pnl_site_ff.pnl)))='Automation' AND IF(IF(ISNULL(IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)) AND (PROD_SERV_ID='97789' OR PROD_SERV_ID='119827'),'Florida',IF(PROD_SERV_ID='100588','Dallas',IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)))='Florida','XA',IF(PROD_SERV_ID='100588','MapFrame',IF(SUBSTR(IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))) in ('Core GIS','GIS Core','Smallworld View','Smallworld') OR
substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,23)='Core Spatial Technology' OR 
(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='PNI' OR substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,26)='Physical Network Inventory','PNI',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,11)='Cornerstone','Cornerstone',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld Translator Suite (SOMs)' OR IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Translators (SOMs)','SOMs',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Electric Office'))='Electric Office'
 ,'EO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Global Transmission Office'))='Global Transmission Office'
,'GTO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Water Office'))='Water Office'
,'WO',
IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))))))))))))))))))))),0,7)='PowerOn' or PROD_SERV_ID='47866','PowerOn',IF(intl_tbl_all_cases.PROD_SERV_ID='99159' OR intl_tbl_all_cases.PROD_SERV_ID='99423' OR intl_tbl_all_cases.PROD_SERV_ID='35028' OR intl_tbl_all_cases.PROD_SERV_ID='33643' OR intl_tbl_all_cases.PROD_SERV_ID='27969','Smallworld',intl_tbl_pnl_site_ff.product))))='ENMAC' AND intl_tbl_all_cases.customer_business_name='Western Power Distribution'),CONCAT('SEVERITY',IF((SUBSTR(upper(trim(intl_tbl_all_cases.SEVERITY)),LENGTH(upper(trim(intl_tbl_all_cases.SEVERITY))),1)+2)>5, 5, SUBSTR(upper(trim(intl_tbl_all_cases.SEVERITY)),LENGTH(upper(trim(intl_tbl_all_cases.SEVERITY))),1)+2)),UPPER(intl_tbl_all_cases.SEVERITY)) AS SEVERITY,

IF(IF(ISNULL(IF(intl_tbl_all_cases.PROD_SERV_ID='99159' OR intl_tbl_all_cases.PROD_SERV_ID ='99423' OR intl_tbl_all_cases.PROD_SERV_ID= '35028','Swisscom',intl_tbl_all_cases.GE_SITE)) AND (intl_tbl_all_cases.PROD_SERV_ID='97789' OR intl_tbl_all_cases.PROD_SERV_ID='119827'),'Florida',IF(intl_tbl_all_cases.PROD_SERV_ID='100588','Dallas',IF(intl_tbl_all_cases.PROD_SERV_ID='99159' OR intl_tbl_all_cases.PROD_SERV_ID ='99423' OR intl_tbl_all_cases.PROD_SERV_ID= '35028','Swisscom',intl_tbl_all_cases.GE_SITE)))='Florida' and isnull(if(substr(IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))) in ('Core GIS','GIS Core','Smallworld View','Smallworld') OR
substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,23)='Core Spatial Technology' OR 
(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='PNI' OR substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,26)='Physical Network Inventory','PNI',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,11)='Cornerstone','Cornerstone',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld Translator Suite (SOMs)' OR IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Translators (SOMs)','SOMs',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Electric Office'))='Electric Office'
 ,'EO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Global Transmission Office'))='Global Transmission Office'
,'GTO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Water Office'))='Water Office'
,'WO',
IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))))))))))))))))))))),0,7)='PowerOn' or PROD_SERV_ID='47866','Automation',if(intl_tbl_all_cases.PROD_SERV_ID in ('99159','99423','35028','33643','27969''100588')
,'Smallworld',intl_tbl_pnl_site_ff.pnl))),'Automation',if(substr(IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))) in ('Core GIS','GIS Core','Smallworld View','Smallworld') OR
substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,23)='Core Spatial Technology' OR 
(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='PNI' OR substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,26)='Physical Network Inventory','PNI',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,11)='Cornerstone','Cornerstone',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld Translator Suite (SOMs)' OR IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Translators (SOMs)','SOMs',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Electric Office'))='Electric Office'
 ,'EO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Global Transmission Office'))='Global Transmission Office'
,'GTO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Water Office'))='Water Office'
,'WO',
IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))))))))))))))))))))),0,7)='PowerOn' or PROD_SERV_ID='47866','Automation',if(intl_tbl_all_cases.PROD_SERV_ID in ('99159','99423','35028','33643','27969''100588')
,'Smallworld',intl_tbl_pnl_site_ff.pnl))) AS P_L,


IF(IF(ISNULL(IF(intl_tbl_all_cases.PROD_SERV_ID in ('99159', '99423', '35028'),'Swisscom',intl_tbl_all_cases.GE_SITE)) AND (intl_tbl_all_cases.PROD_SERV_ID='97789' OR intl_tbl_all_cases.PROD_SERV_ID='119827'),'Florida',IF(intl_tbl_all_cases.PROD_SERV_ID='100588','Dallas',IF(intl_tbl_all_cases.PROD_SERV_ID in ('99159', '99423', '35028'),'Swisscom',intl_tbl_all_cases.GE_SITE)))='Florida','XA',IF(intl_tbl_all_cases.PROD_SERV_ID='100588','MapFrame',IF(SUBSTR(IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))) in ('Core GIS','GIS Core','Smallworld View','Smallworld') OR
substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,23)='Core Spatial Technology' OR 
(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='PNI' OR substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,26)='Physical Network Inventory','PNI',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,11)='Cornerstone','Cornerstone',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld Translator Suite (SOMs)' OR IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Translators (SOMs)','SOMs',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Electric Office'))='Electric Office'
 ,'EO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Global Transmission Office'))='Global Transmission Office'
,'GTO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Water Office'))='Water Office'
,'WO',
IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))))))))))))))))))))),0,7)='PowerOn' or intl_tbl_all_cases.PROD_SERV_ID='47866','PowerOn',IF(intl_tbl_all_cases.PROD_SERV_ID in ('99159','99423','35028','33643','27969'),'Smallworld',intl_tbl_pnl_site_ff.product)))) as PRODUCT_LINE,

if(PROD_SERV_ID='100588','Americas',if(((if(IF(ISNULL(IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)) AND (PROD_SERV_ID='97789' OR PROD_SERV_ID='119827'),'Florida',if(PROD_SERV_ID='100588','Dallas',IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)))='Florida','XA',if(PROD_SERV_ID='100588','MapFrame',if(SUBSTR(if(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Core GIS' OR
nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='GIS Core' OR
substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,23)='Core Spatial Technology' OR
nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld View' OR
nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld'  OR
(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld GIS' AND substr(if(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
if(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld GIS' AND substr(if(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
if(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld GIS' AND substr(if(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
if(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='PNI' OR substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,26)='Physical Network Inventory','PNI',
if( substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,11)='Cornerstone','Cornerstone',
if( substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld Translator Suite (SOMs)' OR nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Translators (SOMs)','SOMs',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Electric Office'))='Electric Office'
,'EO',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Global Transmission Office'))='Global Transmission Office'
,'GTO',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Water Office'))='Water Office'
,'WO',
nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT))))))))))))))))))),0,7)='PowerOn' or PROD_SERV_ID='47866','PowerOn',if(PROD_SERV_ID='99159'
OR PROD_SERV_ID='99423'
OR PROD_SERV_ID='35028'
OR PROD_SERV_ID='33643'
OR PROD_SERV_ID='27969','Smallworld',intl_tbl_pnl_site_ff.PRODUCT))))='Smallworld'  AND if(ISNULL(if(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)) AND (PROD_SERV_ID='97789' OR PROD_SERV_ID='119827'),'Florida',if(PROD_SERV_ID='100588','Dallas',if(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)))='Denver') OR if(IF(ISNULL(IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)) AND (PROD_SERV_ID='97789' OR PROD_SERV_ID='119827'),'Florida',if(PROD_SERV_ID='100588','Dallas',IF(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)))='Florida','XA',if(PROD_SERV_ID='100588','MapFrame',if(SUBSTR(if(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Core GIS' OR
nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='GIS Core' OR
substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,23)='Core Spatial Technology' OR
nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld View' OR
nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld'  OR
(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld GIS' AND substr(if(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
if(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld GIS' AND substr(if(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
if(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld GIS' AND substr(if(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
if(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='PNI' OR substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,26)='Physical Network Inventory','PNI',
if( substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,11)='Cornerstone','Cornerstone',
if( substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Smallworld Translator Suite (SOMs)' OR nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT)='Translators (SOMs)','SOMs',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Electric Office'))='Electric Office'
,'EO',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Global Transmission Office'))='Global Transmission Office'
,'GTO',
if(substr(nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT),0,LENGTH('Water Office'))='Water Office'
,'WO',
nvl(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)),PRODUKT))))))))))))))))))),0,7)='PowerOn' or PROD_SERV_ID='47866','PowerOn',if(PROD_SERV_ID='99159'
OR PROD_SERV_ID='99423'
OR PROD_SERV_ID='35028'
OR PROD_SERV_ID='33643'
OR PROD_SERV_ID='27969','Smallworld',intl_tbl_pnl_site_ff.PRODUCT))))='MapFrame'),
if(ISNULL(lacust.Region),'North America',lacust.Region),if(PROD_SERV_ID='23622' 
--OR v_PRODUCT_LINE2='XA' OR v_PRODUCT_LINE2='PowerOn'  
,if(isnull(intl_tbl_cust_region_ff.Region),IF(if(ISNULL(if(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)) AND (PROD_SERV_ID='97789' OR PROD_SERV_ID='119827'),'Florida',if(PROD_SERV_ID='100588','Dallas',if(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)))='Florida' AND ISNULL(IF(PROD_SERV_ID='99159'
OR PROD_SERV_ID='99423'
OR PROD_SERV_ID='35028'
OR PROD_SERV_ID='33643'
OR PROD_SERV_ID='27969'
OR PROD_SERV_ID='100588','Europe',intl_tbl_pnl_site_ff.Region)),'Americas',IF(PROD_SERV_ID='99159'
OR PROD_SERV_ID='99423'
OR PROD_SERV_ID='35028'
OR PROD_SERV_ID='33643'
OR PROD_SERV_ID='27969'
OR PROD_SERV_ID='100588','Europe',intl_tbl_pnl_site_ff.Region)),intl_tbl_cust_region_ff.Region),IF(if(ISNULL(if(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)) AND (PROD_SERV_ID='97789' OR PROD_SERV_ID='119827'),'Florida',if(PROD_SERV_ID='100588','Dallas',if(PROD_SERV_ID='99159' OR PROD_SERV_ID ='99423' OR PROD_SERV_ID= '35028','Swisscom',GE_SITE)))='Florida' AND ISNULL(IF(PROD_SERV_ID='99159'
OR PROD_SERV_ID='99423'
OR PROD_SERV_ID='35028'
OR PROD_SERV_ID='33643'
OR PROD_SERV_ID='27969'
OR PROD_SERV_ID='100588','Europe',intl_tbl_pnl_site_ff.Region)),'Americas',IF(PROD_SERV_ID='99159'
OR PROD_SERV_ID='99423'
OR PROD_SERV_ID='35028'
OR PROD_SERV_ID='33643'
OR PROD_SERV_ID='27969'
OR PROD_SERV_ID='100588','Europe',intl_tbl_pnl_site_ff.Region))))) AS REGION,

if(isnull(IF((substr(intl_tbl_all_cases.RESOLUTION_RESPONSIBILITY, 2,10)='roduct Man' OR substr(intl_tbl_all_cases.RESOLUTION_RESPONSIBILITY, 3,10)='roduct Man') ,'Product Management',intl_tbl_all_cases.RESOLUTION_RESPONSIBILITY)),
if(isnull(intl_tbl_resp_ff.Owner),'Support',intl_tbl_resp_ff.Owner),IF((substr(intl_tbl_all_cases.RESOLUTION_RESPONSIBILITY, 2,10)='roduct Man' OR substr(intl_tbl_all_cases.RESOLUTION_RESPONSIBILITY, 3,10)='roduct Man') ,
'Product Management',intl_tbl_all_cases.RESOLUTION_RESPONSIBILITY)) as RESPONSIBLE,
intl_tbl_all_cases.CASE_OWNER,
upper(IF(ISNULL(IF(intl_tbl_all_cases.PROD_SERV_ID='99159'  OR intl_tbl_all_cases.PROD_SERV_ID= '99423' Or intl_tbl_all_cases.PROD_SERV_ID = '35028','Swisscom',IF(intl_tbl_all_cases.PROD_SERV_ID='33643','ERDF',IF(intl_tbl_all_cases.PROD_SERV_ID='27969','GRDF',intl_tbl_all_cases.customer_business_name)))) AND (intl_tbl_all_cases.PROD_SERV_ID='21983' OR intl_tbl_all_cases.PROD_SERV_ID='21984'),'Internal',IF(intl_tbl_all_cases.PROD_SERV_ID='99159'  OR intl_tbl_all_cases.PROD_SERV_ID= '99423' Or intl_tbl_all_cases.PROD_SERV_ID = '35028','Swisscom',IF(intl_tbl_all_cases.PROD_SERV_ID='33643','ERDF',IF(intl_tbl_all_cases.PROD_SERV_ID='27969','GRDF',intl_tbl_all_cases.customer_business_name)))))
AS CUSTOMER,
'' AS ORACLE_ID,

IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))) in ('Core GIS','GIS Core','Smallworld View','Smallworld') OR
substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,23)='Core Spatial Technology' OR 
(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='PNI' OR substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,26)='Physical Network Inventory','PNI',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,11)='Cornerstone','Cornerstone',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld Translator Suite (SOMs)' OR IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Translators (SOMs)','SOMs',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Electric Office'))='Electric Office'
 ,'EO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Global Transmission Office'))='Global Transmission Office'
,'GTO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Water Office'))='Water Office'
,'WO',
IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))))))))))))))))))))) AS PRODUCT,

IF(IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))) in ('Core GIS','GIS Core','Smallworld View','Smallworld') OR
substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,23)='Core Spatial Technology' OR 
(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='CST'),'Core',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='NRM','NRM',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld GIS' AND substr(IF(ISNULL(VERSION),PRODUKTVERSION,VERSION),0,3)='Fachschalen','Fachschalen',
IF(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='PNI' OR substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,26)='Physical Network Inventory','PNI',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,11)='Cornerstone','Cornerstone',
IF( substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Force Automation'))='Field Force Automation'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Workforce Management'))='Workforce Management','FFA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Field Information System'))='Field Information System'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Field Information System'))='Smallworld Field Information System','FIS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Internet Application Server'))='Internet Application Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Smallworld Internet Application Server'))='Smallworld Internet Application Server','SIAS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Resource Manager'))='Network Resource Manager'
,'NRM',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Object Manager'))='Spatial Object Manager'
OR  IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Smallworld Translator Suite (SOMs)' OR IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))='Translators (SOMs)','SOMs',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Spatial Intelligence'))='Spatial Intelligence'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,(LENGTH('Spatial Intelligence'))*-1)='Spatial Intelligence' ,'SI',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Electric Office'))='Electric Office'
 ,'EO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Network Inventory Gateway'))='Network Inventory Gateway'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('NI Gateway'))='NI Gateway','NIG',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Server'))='GeoSpatial Server'
OR  substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Geo Spatial Server'))='Geo Spatial Server','GSS',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('GeoSpatial Analysis'))='GeoSpatial Analysis'
,'GSA',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Gas Distribution Office'))='Gas Distribution Office'
,'GDO',
IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Global Transmission Office'))='Global Transmission Office','GTO',IF(substr(IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),0,LENGTH('Water Office'))='Water Office','WO',
IF(ISNULL(if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT))),intl_tbl_all_cases.PRODUKT,if(intl_tbl_all_cases.PRODUCT='==PowerOn==','ENMAC',if(intl_tbl_all_cases.PRODUCT='==Non-Product==','Non Product',intl_tbl_all_cases.PRODUCT)))))))))))))))))))))='Core' AND NOT ISNULL(if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='4 - SWAF' or IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 4','4', 
if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 4.1','4.1',
if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 4.1.1','4.1.1',
if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='3.3 - Prof' or IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 3.3(0)','3.3' ,
if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='3.2.0' OR IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 3.2(1)' OR IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 3.2.(1)','3.2' ,
If(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='3.1(0) SP2' or IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 3.1(0) SP2','3.1',
IF(SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,3)='CST' AND  SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,(LENGTH(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION))-4)*-1)='3.1(0) SP2' ,'3.1',
IF(SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,3)='CST' AND  SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,(LENGTH(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION))-4)*-1)='3.2(1)' ,'3.2',
IF(SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,3)='CST' AND  SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,(LENGTH(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION))-4)*-1)='3.3(0)' ,'3.3',NULL)))))))))),if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='4 - SWAF' or IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 4','4', 
if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 4.1','4.1',
if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 4.1.1','4.1.1',
if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='3.3 - Prof' or IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 3.3(0)','3.3' ,
if(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='3.2.0' OR IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 3.2(1)' OR IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 3.2.(1)','3.2' ,
If(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='3.1(0) SP2' or IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)='CST 3.1(0) SP2','3.1',
IF(SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,3)='CST' AND  SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,(LENGTH(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION))-4)*-1)='3.1(0) SP2' ,'3.1',
IF(SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,3)='CST' AND  SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,(LENGTH(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION))-4)*-1)='3.2(1)' ,'3.2',
IF(SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,3)='CST' AND  SUBSTR(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION),0,(LENGTH(IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION))-4)*-1)='3.3(0)' ,'3.3',NULL))))))))),IF(ISNULL(intl_tbl_all_cases.VERSION),intl_tbl_all_cases.PRODUKTVERSION,intl_tbl_all_cases.VERSION)) AS VERSION,


if(ISNULL(case when regexp_extract(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE,'(19|20)[0-9]{2}(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])',0) = '' 
     then NULL 
     else TO_DATE( ACTUAL_COMPLETION_DATE)
end),DATEDIFF(current_date,case when regexp_extract(intl_tbl_all_cases.OPEN_DATE,'(19|20)[0-9]{2}(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])',0) = '' 
     then NULL 
     else TO_DATE( intl_tbl_all_cases.OPEN_DATE)
end),DATEDIFF(case when regexp_extract(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE,'(19|20)[0-9]{2}(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])',0) = '' 
     then NULL 
     else TO_DATE( intl_tbl_all_cases.ACTUAL_COMPLETION_DATE)
end,case when regexp_extract(intl_tbl_all_cases.OPEN_DATE,'(19|20)[0-9]{2}(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])',0) = '' 
     then NULL 
     else TO_DATE( intl_tbl_all_cases.OPEN_DATE)
end)) AS AGE,
day(case when date_game(OPEN_DATE) = 'False' then null else date_game(OPEN_DATE) end) AS DAY,
month(case when date_game(OPEN_DATE) = 'False' then null else date_game(OPEN_DATE) end) AS MONTH,
year(case when date_game(OPEN_DATE) = 'False' then null else date_game(OPEN_DATE) end) AS YEAR,
day(case when date_game(WANT_DATE) = 'False' then null else date_game(WANT_DATE) end) AS DAY1,
month(case when date_game(WANT_DATE) = 'False' then null else date_game(WANT_DATE) end) AS MONTH1,
year(case when date_game(WANT_DATE) = 'False' then null else date_game(WANT_DATE) end) AS YEAR1,
case when CASE_SOURCE='OPEN_CASES' then day(case when date_game(WANT_DATE) = 'False' then null else date_game(WANT_DATE) end) 
else
day(case when date_game(PLANNED_DATE) = 'False' then null else date_game(PLANNED_DATE) end) end  AS DAY2,
case when CASE_SOURCE='OPEN_CASES' then month(case when date_game(WANT_DATE) = 'False' then null else date_game(WANT_DATE) end) 
else
month(case when date_game(PLANNED_DATE) = 'False' then null else date_game(PLANNED_DATE) end) end  AS MONTH2,
case when CASE_SOURCE='OPEN_CASES' then year(case when date_game(WANT_DATE) = 'False' then null else date_game(WANT_DATE) end) 
else
year(case when date_game(PLANNED_DATE) = 'False' then null else date_game(PLANNED_DATE) end) end AS YEAR2,
day(case when date_game(LAST_MODIFIED_DT) = 'False' then null else date_game(LAST_MODIFIED_DT) end) AS DAY3,
month(case when date_game(LAST_MODIFIED_DT) = 'False' then null else date_game(LAST_MODIFIED_DT) end) AS MONTH3,
year(case when date_game(LAST_MODIFIED_DT) = 'False' then null else date_game(LAST_MODIFIED_DT) end) AS YEAR3,
day(case when date_game(date_add(intl_tbl_all_cases.OPEN_DATE,intl_tbl_slamaster_ff.SLA)) = 'False' then null else date_game(date_add(intl_tbl_all_cases.OPEN_DATE,intl_tbl_slamaster_ff.SLA)) end) AS DAY4,
month(case when date_game(date_add(intl_tbl_all_cases.OPEN_DATE,intl_tbl_slamaster_ff.SLA)) = 'False' then null else date_game(date_add(intl_tbl_all_cases.OPEN_DATE,intl_tbl_slamaster_ff.SLA)) end) AS MONTH4,
year(case when date_game(date_add(intl_tbl_all_cases.OPEN_DATE,intl_tbl_slamaster_ff.SLA)) = 'False' then null else date_game(date_add(intl_tbl_all_cases.OPEN_DATE,intl_tbl_slamaster_ff.SLA)) end) AS YEAR4,
day(case when date_game(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE) = 'False' then null else date_game(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE) end) AS DAY5,
month(case when date_game(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE) = 'False' then null else date_game(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE) end) AS MONTH5,
year(case when date_game(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE) = 'False' then null else date_game(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE) end) AS YEAR5,
NULL,
case when date_game(intl_tbl_all_cases.WANT_DATE) = 'False' then null else date_game(intl_tbl_all_cases.WANT_DATE) end as WANT_DATE,
datediff(current_date,nvl(case when date_game(intl_tbl_all_cases.WANT_DATE) = 'False' then null else date_game(intl_tbl_all_cases.WANT_DATE) end,current_timestamp)) VTW_OPEN,
datediff(nvl(case when date_game(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE) = 'False' then null else date_game(intl_tbl_all_cases.ACTUAL_COMPLETION_DATE) end,to_date('1200-01-01'))
,nvl(case when date_game(WANT_DATE) = 'False' then null else date_game(WANT_DATE) end,to_date('1200-01-01'))) VTW_CLOSED,
intl_tbl_all_cases.TYPE,
intl_tbl_all_cases.STATUS,
intl_tbl_all_cases.responsibility,
NULL, --overdue
IF(PROD_SERV_ID='26490',nvl(case when date_game(RESTORATION_DATE) = 'False' then null else date_game(RESTORATION_DATE) end,to_date('1200-01-01')),
IF((PROD_SERV_ID='99159' OR PROD_SERV_ID='99423' OR PROD_SERV_ID='35028'),NULL,nvl(case when date_game(WORKAROUND) = 'False' then null else date_game(WORKAROUND) end,to_date('1200-01-01')))) workaround,
IF(DATEDIFF(nvl(case when date_game(OPEN_DATE) = 'False' then null else date_game(OPEN_DATE) end,to_date('1200-01-01'))
,nvl(case when date_game(WORKAROUND) = 'False' then null else date_game(WORKAROUND) end,to_date('1200-01-01')))>0,
DATEDIFF(nvl(case when date_game(OPEN_DATE) = 'False' then null else date_game(OPEN_DATE) end,to_date('1200-01-01')),
nvl(case when date_game(WORKAROUND) = 'False' then null else date_game(WORKAROUND) end,to_date('1200-01-01'))),0) SPAN_TO_WORKAROUND,
nvl(case when date_game(RESTORATION_DATE) = 'False' then null else date_game(RESTORATION_DATE) end,to_date('1200-01-01')) RESTORATION_DATE,
intl_tbl_all_cases.case_type as CUSTOMER_CASE_TYPE,
intl_tbl_all_cases.date_dofficialisation as DATE_D_OFFICIALISATION,
intl_tbl_all_cases.ACTUAL_COMPLETION_DATE,
intl_tbl_all_cases.SUBJECT,
intl_tbl_slamaster_ff.SLA,
'' AS BUSINESS_DAYS,
'' AS OTD_STATUS,
'SPARK_IQP_SRVC_SC_ALL_CASES' AS CREATED_BY,
current_timestamp AS CREATED_DATE,
intl_tbl_all_cases.case_owner AS ATTRIBUTE1,
'' AS ATTRIBUTE2,
'' AS ATTRIBUTE3,
'' AS ATTRIBUTE4,
'' AS ATTRIBUTE5,
'' AS ATTRIBUTE6,
'' AS ATTRIBUTE7,
'' AS ATTRIBUTE8,
'' AS ATTRIBUTE9
from intl_tbl_all_cases
left join intl_tbl_pnl_site_ff
on intl_tbl_pnl_site_ff.Community_ID = intl_tbl_all_cases.PROD_SERV_ID
left join intl_tbl_cust_region_ff
on intl_tbl_cust_region_ff.CUSTOMER= ( IF (SUBSTR( trim(IF(SUBSTR( trim(IF(SUBSTR( trim(intl_tbl_all_cases.customer_business_name) ,0,7)='Svenska','Svenska',if(SUBSTR(trim(intl_tbl_all_cases.customer_business_name),0,10)='Chilquinta','Chilquinta',intl_tbl_all_cases.customer_business_name))) ,0,5)='U.T.E','U.T.E',IF(SUBSTR(trim(intl_tbl_all_cases.customer_business_name),0,7)='Svenska','Svenska',if(SUBSTR(trim(intl_tbl_all_cases.customer_business_name),0,10)='Chilquinta','Chilquinta',intl_tbl_all_cases.customer_business_name)))) ,0,6)='Axxiom','Axxiom',IF(SUBSTR(trim(IF(SUBSTR(trim(intl_tbl_all_cases.customer_business_name),0,7)='Svenska','Svenska',if(SUBSTR(trim(intl_tbl_all_cases.customer_business_name),0,10)='Chilquinta','Chilquinta',intl_tbl_all_cases.customer_business_name))),0,5)='U.T.E','U.T.E',IF(SUBSTR(trim(intl_tbl_all_cases.customer_business_name),0,7)='Svenska','Svenska',if(SUBSTR(trim(intl_tbl_all_cases.customer_business_name),0,10)='Chilquinta','Chilquinta',intl_tbl_all_cases.customer_business_name)))))
left join intl_tbl_resp_ff
on intl_tbl_resp_ff.Reason_Code = intl_tbl_all_cases.Reason
left join intl_tbl_slamaster_ff
on intl_tbl_slamaster_ff.SEVERITY = intl_tbl_all_cases.SEVERITY
left join g00103.iqp_srvc_la_customers_ff lacust on (lacust.la_customers = if(SUBSTR(ltrim(rtrim(if(SUBSTR(ltrim(rtrim(if(SUBSTR(ltrim(rtrim(customer_business_name)),0,7)='Svenska','Svenska',if(SUBSTR(ltrim(rtrim(customer_business_name)),0,10)='Chilquinta','Chilquinta',customer_business_name)))),0,5)='U.T.E','U.T.E',if(SUBSTR(ltrim(rtrim(customer_business_name)),0,7)='Svenska','Svenska',if(SUBSTR(ltrim(rtrim(customer_business_name)),0,10)='Chilquinta','Chilquinta',customer_business_name))))),0,6)='Axxiom','Axxiom',if(SUBSTR(ltrim(rtrim(if(SUBSTR(ltrim(rtrim(customer_business_name)),0,7)='Svenska','Svenska',if(SUBSTR(ltrim(rtrim(customer_business_name)),0,10)='Chilquinta','Chilquinta',customer_business_name)))),0,5)='U.T.E','U.T.E',if(SUBSTR(ltrim(rtrim(customer_business_name)),0,7)='Svenska','Svenska',if(SUBSTR(ltrim(rtrim(customer_business_name)),0,10)='Chilquinta','Chilquinta',customer_business_name)))))
WHERE
IF(IF((ISNULL(intl_tbl_all_cases.customer_business_name) AND (PROD_SERV_ID!='28914' AND PROD_SERV_ID!='35028'  AND PROD_SERV_ID!='99159' AND PROD_SERV_ID!='99423' 
AND PROD_SERV_ID!='21983' AND PROD_SERV_ID!='21984'  AND IF(ISNULL(intl_tbl_all_cases.PRODUCT),'NA',intl_tbl_all_cases.PRODUCT)!='XA/21')),'INVALID','VALID') ='INVALID' OR 
(IF(PROD_SERV_ID='38507' OR PROD_SERV_ID='41299' OR PROD_SERV_ID='28914' ,'INVALID','VALID'))='INVALID' ,'INVALID','VALID') = 'VALID'
""")
//Final Query to Write to DB
val finalResultToWriteWithPartition = finalResultToWrite.coalesce(10)
finalResultToWriteWithPartition.createOrReplaceTempView("internalFinalResultTable") 
//if (deBug) Utils.printLog(deBug,tableName + ": Writing to Table Count: " + formatter.format(finalResultToWrite.count))
val sql = s"""Insert overwrite table $tableName select * from internalFinalResultTable"""
spark.sql(sql)
// Wirite to DB with final result
//finalResultToWriteWithPartition.write.mode("overwrite").saveAsTable(tableName)
if (deBug) Utils.printLog(deBug, tableName + ": Processing Completed ...")
} catch {
  case e: Throwable => {
    isSuccess=false
    errorMessage=e.getMessage()
      }
  }
  finally {
 val status = if (isSuccess) "SUCCESS" else "FAILED"
 if (deBug) Utils.printLog(deBug, tableName + ": Writing to audit table with status: " + status)
 Utils.auditRecord(spark, Utils.AuditRecord(batchNumber, tableName, beforeTimestamp, status, errorMessage))
 spark.stop
   }
  }
}